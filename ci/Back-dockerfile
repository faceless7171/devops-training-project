FROM gradle:4.4.1-jdk8-alpine AS builder

WORKDIR /home/gradle/project

COPY --chown=gradle:gradle backend /home/gradle/project

RUN gradle build -x test 1>/dev/null


FROM openjdk:8-jre-alpine

ENV DB_USERNAME="admin" DB_PASSWORD="admin12345" DB_URL="nsoroka-training-rds.cqnuqytrqlro.us-east-1.rds.amazonaws.com" DB_PORT="3306" DB_NAME="mydb"

EXPOSE 8080

WORKDIR /home/gradle/project

COPY --from=builder /home/gradle/project/build/libs/project-0.0.1-SNAPSHOT.jar .

ENTRYPOINT java -jar project-0.0.1-SNAPSHOT.jar